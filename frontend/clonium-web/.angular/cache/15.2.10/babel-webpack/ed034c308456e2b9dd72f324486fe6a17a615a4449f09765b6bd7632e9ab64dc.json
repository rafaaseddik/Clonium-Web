{"ast":null,"code":"import { Player } from '../../models/player.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../core/services/room.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nconst _c0 = [\"scrollerList\"];\nfunction ChatBoxComponent_div_0_i_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\", 5);\n  }\n}\nfunction ChatBoxComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function ChatBoxComponent_div_0_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.openBox());\n    });\n    i0.ɵɵtext(2, \"Messages\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, ChatBoxComponent_div_0_i_3_Template, 1, 0, \"i\", 4);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.hasNewMessage);\n  }\n}\nfunction ChatBoxComponent_div_1_div_8_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 23);\n  }\n}\nfunction ChatBoxComponent_div_1_div_8_img_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 24);\n  }\n}\nfunction ChatBoxComponent_div_1_div_8_img_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 25);\n  }\n}\nfunction ChatBoxComponent_div_1_div_8_img_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 26);\n  }\n}\nconst _c1 = function (a0, a1, a2, a3) {\n  return {\n    \"msg-p1\": a0,\n    \"msg-p2\": a1,\n    \"msg-p3\": a2,\n    \"msg-p4\": a3\n  };\n};\nfunction ChatBoxComponent_div_1_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵtemplate(1, ChatBoxComponent_div_1_div_8_img_1_Template, 1, 0, \"img\", 18);\n    i0.ɵɵtemplate(2, ChatBoxComponent_div_1_div_8_img_2_Template, 1, 0, \"img\", 19);\n    i0.ɵɵtemplate(3, ChatBoxComponent_div_1_div_8_img_3_Template, 1, 0, \"img\", 20);\n    i0.ɵɵtemplate(4, ChatBoxComponent_div_1_div_8_img_4_Template, 1, 0, \"img\", 21);\n    i0.ɵɵelementStart(5, \"p\", 22);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const message_r7 = ctx.$implicit;\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"from-me\", message_r7.sender == ctx_r6.player);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", message_r7.sender == ctx_r6.Player.PLAYER_1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", message_r7.sender == ctx_r6.Player.PLAYER_2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", message_r7.sender == ctx_r6.Player.PLAYER_3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", message_r7.sender == ctx_r6.Player.PLAYER_4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction4(8, _c1, message_r7.sender == ctx_r6.Player.PLAYER_1, message_r7.sender == ctx_r6.Player.PLAYER_2, message_r7.sender == ctx_r6.Player.PLAYER_3, message_r7.sender == ctx_r6.Player.PLAYER_4));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(message_r7.text);\n  }\n}\nfunction ChatBoxComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 6)(1, \"div\", 7);\n    i0.ɵɵtext(2, \"Messages \");\n    i0.ɵɵelementStart(3, \"div\", 8);\n    i0.ɵɵlistener(\"click\", function ChatBoxComponent_div_1_Template_div_click_3_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.displayInbox = false);\n    });\n    i0.ɵɵelement(4, \"i\", 9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 10)(6, \"div\", 11, 12);\n    i0.ɵɵtemplate(8, ChatBoxComponent_div_1_div_8_Template, 7, 13, \"div\", 13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 14)(10, \"input\", 15);\n    i0.ɵɵlistener(\"ngModelChange\", function ChatBoxComponent_div_1_Template_input_ngModelChange_10_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.currentMessage = $event);\n    })(\"keyup.enter\", function ChatBoxComponent_div_1_Template_input_keyup_enter_10_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.sendMessage());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"i\", 16);\n    i0.ɵɵlistener(\"click\", function ChatBoxComponent_div_1_Template_i_click_11_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.sendMessage());\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.messages);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.currentMessage);\n  }\n}\n/**\n * @description\n * The chatbox UI component, available only in an online game\n *\n * @author\n * Rafaa Seddik\n */\nexport let ChatBoxComponent = /*#__PURE__*/(() => {\n  class ChatBoxComponent {\n    constructor(roomService) {\n      this.roomService = roomService;\n      // The current player\n      this.player = Player.PLAYER_1;\n      // The current message content\n      this.currentMessage = \"\";\n      // The list of messages\n      this.messages = [];\n      // Toggle the display of the messages list\n      this.displayInbox = false;\n      // Toggle the display of a newly received message notification icon\n      this.hasNewMessage = false;\n      // Type declaration\n      this.Player = Player;\n    }\n    /**\n     * Subscribe to the receiveMessage Socket Event\n     */\n    ngOnInit() {\n      this.roomService.receiveMessage.asObservable().subscribe(message => {\n        this.messages.push(message);\n        if (this.displayInbox == false) this.hasNewMessage = true;\n        setTimeout(() => this.scrollToBottom(), 30);\n      });\n    }\n    /**\n     * @description\n     * The send message event handler\n     * @author\n     * Rafaa Seddik\n     */\n    sendMessage() {\n      if (this.currentMessage.length) {\n        this.roomService.sendMessage(this.currentMessage, this.player);\n        this.currentMessage = '';\n        setTimeout(() => this.scrollToBottom(), 30);\n      }\n    }\n    /**\n     * @description\n     * Opens the list of message box\n     * @author\n     * Rafaa Seddik\n     */\n    openBox() {\n      this.displayInbox = true;\n      this.hasNewMessage = false;\n      setTimeout(() => this.scrollToBottom(), 30);\n    }\n    /**\n     * @description\n     * Scroll to the bottom of the list messages\n     * @author\n     * Rafaa Seddik\n     */\n    scrollToBottom() {\n      try {\n        if (this.displayInbox) {\n          this.scrollList.nativeElement.scrollTop = this.scrollList.nativeElement.scrollHeight;\n        }\n      } catch (err) {}\n    }\n    static #_ = this.ɵfac = function ChatBoxComponent_Factory(t) {\n      return new (t || ChatBoxComponent)(i0.ɵɵdirectiveInject(i1.RoomService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ChatBoxComponent,\n      selectors: [[\"app-chat-box\"]],\n      viewQuery: function ChatBoxComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.scrollList = _t.first);\n        }\n      },\n      inputs: {\n        player: \"player\"\n      },\n      decls: 2,\n      vars: 2,\n      consts: [[\"class\", \"display-inbox\", 4, \"ngIf\"], [\"class\", \"chat-box\", 4, \"ngIf\"], [1, \"display-inbox\"], [1, \"btn\", \"text-dark\", 3, \"click\"], [\"class\", \"mdi mdi-email new-messages\", 4, \"ngIf\"], [1, \"mdi\", \"mdi-email\", \"new-messages\"], [1, \"chat-box\"], [1, \"messages-header\"], [1, \"times-btn\", 3, \"click\"], [1, \"mdi\", \"mdi-close\"], [1, \"messages-list\"], [1, \"message-scroller\"], [\"scrollerList\", \"\"], [\"class\", \"message\", 3, \"from-me\", 4, \"ngFor\", \"ngForOf\"], [1, \"send-message\"], [\"name\", \"submit\", 1, \"form-control-sm\", 3, \"ngModel\", \"ngModelChange\", \"keyup.enter\"], [1, \"mdi\", \"mdi-send\", 3, \"click\"], [1, \"message\"], [\"src\", \"assets/img/cell/blue.png\", \"width\", \"15px\", \"height\", \"15px\", 4, \"ngIf\"], [\"src\", \"assets/img/cell/red.png\", \"width\", \"15px\", \"height\", \"15px\", 4, \"ngIf\"], [\"src\", \"assets/img/cell/green.png\", \"width\", \"15px\", \"height\", \"15px\", 4, \"ngIf\"], [\"src\", \"assets/img/cell/yellow.png\", \"width\", \"15px\", \"height\", \"15px\", 4, \"ngIf\"], [3, \"ngClass\"], [\"src\", \"assets/img/cell/blue.png\", \"width\", \"15px\", \"height\", \"15px\"], [\"src\", \"assets/img/cell/red.png\", \"width\", \"15px\", \"height\", \"15px\"], [\"src\", \"assets/img/cell/green.png\", \"width\", \"15px\", \"height\", \"15px\"], [\"src\", \"assets/img/cell/yellow.png\", \"width\", \"15px\", \"height\", \"15px\"]],\n      template: function ChatBoxComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵtemplate(0, ChatBoxComponent_div_0_Template, 4, 1, \"div\", 0);\n          i0.ɵɵtemplate(1, ChatBoxComponent_div_1_Template, 12, 2, \"div\", 1);\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"ngIf\", !ctx.displayInbox);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.displayInbox);\n        }\n      },\n      dependencies: [i2.NgClass, i2.NgForOf, i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel],\n      encapsulation: 2\n    });\n  }\n  return ChatBoxComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}